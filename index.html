<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>承信環境科技股份有限公司 - 水處理應用薄膜環境解決方案提供者</title>
    <meta name="description" content="承信環境科技股份有限公司，水處理應用薄膜環境解決方案提供者。提供超濾膜UF、MBR、高性能玻璃砂等專業廢水、純水、淨化、海水淡化處理設備與技術服務。">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="image/Envirotech Logo.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/babel-standalone@6.26.0/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Firebase 配置
        const firebaseConfig = {
            apiKey: "AIzaSyBIq7ETOwHbjoqbc1VxZX9bRh6PJWrBD_c",
            authDomain: "jhb101-envirotech-admin-html.firebaseapp.com",
            projectId: "jhb101-envirotech-admin-html",
            storageBucket: "jhb101-envirotech-admin-html.firebasestorage.app",
            messagingSenderId: "175953946350",
            appId: "1:175953946350:web:e614066aa38e2a8738b5ff",
            measurementId: "G-KG0Z532C9S"
        };

        // 初始化 Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        const storage = firebase.storage();

        // 主組件
        function App() {
            const [agencies, setAgencies] = useState([]);
            const [products, setProducts] = useState([]);
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [email, setEmail] = useState("");
            const [password, setPassword] = useState("");
            const [newAgency, setNewAgency] = useState({ name: "", description: "", image: null });
            const [newProduct, setNewProduct] = useState({ name: "", subtitle: "", description: "", image: null });

            // 檢查登錄狀態
            useEffect(() => {
                const unsubscribe = auth.onAuthStateChanged((user) => {
                    setIsAuthenticated(!!user);
                });
                return () => unsubscribe();
            }, []);

            // 獲取品牌和產品數據
            useEffect(() => {
                const fetchData = async () => {
                    const agenciesSnapshot = await db.collection("agencies").get();
                    const productsSnapshot = await db.collection("products").get();
                    setAgencies(agenciesSnapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })));
                    setProducts(productsSnapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })));
                };
                fetchData();
            }, []);

            // 處理登錄
            const handleLogin = async () => {
                try {
                    await auth.signInWithEmailAndPassword(email, password);
                    alert("登錄成功");
                } catch (error) {
                    alert("登錄失敗：" + error.message);
                }
            };

            // 處理登出
            const handleLogout = async () => {
                await auth.signOut();
                setIsAuthenticated(false);
                alert("已登出");
            };

            // 處理圖片上傳
            const uploadImage = async (file, folder) => {
                if (!file) return null;
                const storageRef = storage.ref(`${folder}/${file.name}_${Date.now()}`);
                await storageRef.put(file);
                return await storageRef.getDownloadURL();
            };

            // 新增品牌
            const handleAddAgency = async () => {
                try {
                    const imageUrl = await uploadImage(newAgency.image, "agencies");
                    await db.collection("agencies").add({
                        name: newAgency.name,
                        description: newAgency.description,
                        imageUrl: imageUrl || "",
                    });
                    setNewAgency({ name: "", description: "", image: null });
                    const agenciesSnapshot = await db.collection("agencies").get();
                    setAgencies(agenciesSnapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })));
                    alert("新增品牌成功");
                } catch (error) {
                    alert("新增品牌失敗：" + error.message);
                }
            };

            // 新增產品
            const handleAddProduct = async () => {
                try {
                    const imageUrl = await uploadImage(newProduct.image, "products");
                    await db.collection("products").add({
                        name: newProduct.name,
                        subtitle: newProduct.subtitle,
                        description: newProduct.description,
                        imageUrl: imageUrl || "",
                    });
                    setNewProduct({ name: "", subtitle: "", description: "", image: null });
                    const productsSnapshot = await db.collection("products").get();
                    setProducts(productsSnapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })));
                    alert("新增產品成功");
                } catch (error) {
                    alert("新增產品失敗：" + error.message);
                }
            };

            // 刪除品牌或產品
            const handleDelete = async (type, id) => {
                try {
                    await db.collection(type).doc(id).delete();
                    if (type === "agencies") {
                        const agenciesSnapshot = await db.collection("agencies").get();
                        setAgencies(agenciesSnapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })));
                    } else {
                        const productsSnapshot = await db.collection("products").get();
                        setProducts(productsSnapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })));
                    }
                    alert(`刪除${type === "agencies" ? "品牌" : "產品"}成功`);
                } catch (error) {
                    alert("刪除失敗：" + error.message);
                }
            };

            // 修改品牌或產品
            const handleUpdate = async (type, id, data) => {
                try {
                    const imageUrl = data.image ? await uploadImage(data.image, type) : data.imageUrl;
                    await db.collection(type).doc(id).update({
                        name: data.name,
                        description: data.description,
                        subtitle: data.subtitle || undefined,
                        imageUrl: imageUrl || data.imageUrl || "",
                    });
                    if (type === "agencies") {
                        const agenciesSnapshot = await db.collection("agencies").get();
                        setAgencies(agenciesSnapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })));
                    } else {
                        const productsSnapshot = await db.collection("products").get();
                        setProducts(productsSnapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })));
                    }
                    alert(`修改${type === "agencies" ? "品牌" : "產品"}成功`);
                } catch (error) {
                    alert("修改失敗：" + error.message);
                }
            };

            return (
                <div>
                    <header>
                        <div className="container">
                            <div className="logo">
                                <img src="image/Envirotech Logo.png" alt="承信環境科技股份有限公司 Logo" />
                                <h1>承信環境科技股份有限公司</h1>
                            </ ternary>
                            <nav>
                                <ul>
                                    <li><a href="#about">公司介紹</a></li>
                                    <li><a href="#products">產品介紹</a></li>
                                    <li><a href="#technology">技術資料</a></li>
                                    <li><a href="#contact">聯絡我們</a></li>
                                </ul>
                            </nav>
                        </div>
                    </header>

                    <main>
                        <section id="hero">
                            <div className="container">
                                <h2>水處理應用薄膜環境解決方案提供者</h2>
                                <p>創新技術 · 誠信服務 · 永續發展</p>
                            </div>
                        </section>

                        <section id="about" className="section-padding">
                            <div className="container">
                                <h2>公司介紹</h2>
                                <p>承信環境科技股份有限公司致力於提供全面的水處理環境工程解決方案，並代理水處理專業設備，為環境永續發展貢獻心力。我們秉持創新技術、誠信服務的理念，期許成為您最值得信賴的合作夥伴。</p>
                                <div className="agency-list">
                                    {agencies.map((agency, index) => (
                                        <div key={agency.id} className="agency-item">
                                            <h4>{index + 1}. {agency.name}</h4>
                                            <div className="agency-content">
                                                {agency.imageUrl && <img src={agency.imageUrl} alt={agency.name} />}
                                                <p>{agency.description}</p>
                                            </div>
                                            {isAuthenticated && (
                                                <div>
                                                    <button
                                                        className="bg-red-500 text-white px-2 py-1 rounded mr-2"
                                                        onClick={() => handleDelete("agencies", agency.id)}
                                                    >
                                                        刪除
                                                    </button>
                                                    <button
                                                        className="bg-yellow-500 text-white px-2 py-1 rounded"
                                                        onClick={() => {
                                                            const newName = prompt("新品牌名稱", agency.name);
                                                            const newDescription = prompt("新描述", agency.description);
                                                            if (newName && newDescription) {
                                                                handleUpdate("agencies", agency.id, {
                                                                    name: newName,
                                                                    description: newDescription,
                                                                    imageUrl: agency.imageUrl,
                                                                });
                                                            }
                                                        }}
                                                    >
                                                        修改
                                                    </button>
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </section>

                        <section id="products" className="section-padding section-alt-bg">
                            <div className="container">
                                <h2>產品介紹</h2>
                                <div className="product-grid">
                                    {products.map((product) => (
                                        <div key={product.id} className="product-item">
                                            {product.imageUrl && <img src={product.imageUrl} alt={product.name} />}
                                            <h3>{product.name}</h3>
                                            <h4>{product.subtitle}</h4>
                                            <p>{product.description}</p>
                                            {isAuthenticated && (
                                                <div>
                                                    <button
                                                        className="bg-red-500 text-white px-2 py-1 rounded mr-2"
                                                        onClick={() => handleDelete("products", product.id)}
                                                    >
                                                        刪除
                                                    </button>
                                                    <button
                                                        className="bg-yellow-500 text-white px-2 py-1 rounded"
                                                        onClick={() => {
                                                            const newName = prompt("新產品名稱", product.name);
                                                            const newSubtitle = prompt("新副標題", product.subtitle);
                                                            const newDescription = prompt("新描述", product.description);
                                                            if (newName && newSubtitle && newDescription) {
                                                                handleUpdate("products", product.id, {
                                                                    name: newName,
                                                                    subtitle: newSubtitle,
                                                                    description: newDescription,
                                                                    imageUrl: product.imageUrl,
                                                                });
                                                            }
                                                        }}
                                                    >
                                                        修改
                                                    </button>
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </section>

                        <section id="technology" className="section-padding">
                            <div className="container">
                                <h2>技術資料</h2>
                                <div className="tech-grid">
                                    <div className="tech-item">
                                        <h3>親水性</h3>
                                        <p>決定膜材料對水中有機污染物的吸附程度，進而影響膜的通量。親水性好的膜材料不易吸附有機污染物，能夠保持較高的膜通量，提高過濾效率。</p>
                                    </div>
                                    <div className="tech-item">
                                        <h3>膜孔徑</h3>
                                        <p>孔徑是其最核心的特徵之一，直接決定了膜的分離性能和應用領域。通常指膜表面或膜孔道中的物理孔洞或通道的開孔大小。超濾膜孔徑通常WITH尺寸（微米）或截留分子量（道爾頓）來表征。</p>
                                    </div>
                                    <div className="tech-item">
                                        <h3>全量過濾（死端過濾）</h3>
                                        <p>全部進料液在壓力作用下透過超濾膜，形成透過液，無連續濃縮液排放。適用於原水水質較好、污染物含量低的情況，操作簡單、能耗較低。</p>
                                    </div>
                                    <div className="tech-item">
                                        <h3>錯流過濾</h3>
                                        <p>一部分進料液在壓力作用下透過超濾膜，一部分進料液沿膜表面流動並攜帶被截留的雜質流出膜組件，有效減少膜污染，提高過濾效率。</p>
                                    </div>
                                    <div className="tech-item">
                                        <h3>正沖洗</h3>
                                        <p>利用高速水流在切向於膜表面方向沖刷掉膜表面鬆散的、未能完全形成的污染物層或懸浮物，防止其壓實和累計。</p>
                                    </div>
                                    <div className="tech-item">
                                        <h3>反沖洗</h3>
                                        <p>與過濾運行方向相反的方向施加水流，利用水流的反向壓力，將附著在膜表面的污染物剝離、沖走。</p>
                                    </div>
                                    <div className="tech-item">
                                        <h3>加藥反洗</h3>
                                        <p>將化學藥劑添加到反洗水中，化學品的溶解、分解作用有利於去除單純的物理反洗難以有效清除的有機污染物、微生物和膠體等物質。是介於純物理反洗和完整化學清洗之間的維護性化學清洗。</p>
                                    </div>
                                    <div className="tech-item">
                                        <h3>化學清洗</h3>
                                        <p>當超濾系統的跨膜壓差(ΔP)顯著升高或產水量明顯下降，且通過常規的正沖洗、反沖洗、加藥反洗無法有效恢復性能時所進行的深入、徹底的恢復性化學清洗。通常在離線或系統隔離清洗（即不參與生產）的狀態下進行，使用較高濃度的化學藥劑在膜系統內循環。</p>
                                    </div>
                                    <div className="tech-item">
                                        <h3>高性能玻璃濾料</h3>
                                        <p>產品源自初代可回收平板玻璃，由西班牙研發團隊設計，專為水處理與過濾應用打造，可選擇不同粒徑達到不同的過濾效果。</p>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <section id="contact" className="contact-footer">
                            <div className="container">
                                <div className="contact-grid">
                                    <div className="contact-column">
                                        <h3>承信環境科技</h3>
                                        <p>桃園市中壢區青峰路一段65號13樓</p>
                                    </div>
                                    <div className="contact-column">
                                        <h3>聯絡電話</h3>
                                        <p><a href="tel:+886-3-287-3678">+886-03-287-3678</a></p>
                                    </div>
                                    <div className="contact-column">
                                        <h3>電子郵件</h3>
                                        <p><a href="mailto:Neal@jhb-envirotech.com.tw">Neal@jhb-envirotech.com.tw</a></p>
                                    </div>
                                </div>
                            </div>
                        </section>

                        {isAuthenticated ? (
                            <section id="admin" className="section-padding">
                                <div className="container">
                                    <h2>管理後台</h2>
                                    <button
                                        className="bg-gray-500 text-white px-4 py-2 rounded mb-4"
                                        onClick={handleLogout}
                                    >
                                        登出
                                    </button>

                                    <div className="mb-4">
                                        <h3>新增品牌</h3>
                                        <input
                                            type="text"
                                            placeholder="品牌名稱"
                                            className="border p-2 mr-2 mb-2"
                                            value={newAgency.name}
                                            onChange={(e) => setNewAgency({ ...newAgency, name: e.target.value })}
                                        />
                                        <input
                                            type="text"
                                            placeholder="描述"
                                            className="border p-2 mr-2 mb-2"
                                            value={newAgency.description}
                                            onChange={(e) => setNewAgency({ ...newAgency, description: e.target.value })}
                                        />
                                        <input
                                            type="file"
                                            accept="image/*"
                                            className="border p-2 mr-2 mb-2"
                                            onChange={(e) => setNewAgency({ ...newAgency, image: e.target.files[0] })}
                                        />
                                        <button
                                            className="bg-blue-500 text-white px-4 py-2 rounded"
                                            onClick={handleAddAgency}
                                        >
                                            新增品牌
                                        </button>
                                    </div>

                                    <div>
                                        <h3>新增產品</h3>
                                        <input
                                            type="text"
                                            placeholder="產品名稱"
                                            className="border p-2 mr-2 mb-2"
                                            value={newProduct.name}
                                            onChange={(e) => setNewProduct({ ...newProduct, name: e.target.value })}
                                        />
                                        <input
                                            type="text"
                                            placeholder="副標題"
                                            className="border p-2 mr-2 mb-2"
                                            value={newProduct.subtitle}
                                            onChange={(e) => setNewProduct({ ...newProduct, subtitle: e.target.value })}
                                        />
                                        <input
                                            type="text"
                                            placeholder="描述"
                                            className="border p-2 mr-2 mb-2"
                                            value={newProduct.description}
                                            onChange={(e) => setNewProduct({ ...newProduct, description: e.target.value })}
                                        />
                                        <input
                                            type="file"
                                            accept="image/*"
                                            className="border p-2 mr-2 mb-2"
                                            onChange={(e) => setNewProduct({ ...newProduct, image: e.target.files[0] })}
                                        />
                                        <button
                                            className="bg-blue-500 text-white px-4 py-2 rounded"
                                            onClick={handleAddProduct}
                                        >
                                            新增產品
                                        </button>
                                    </div>
                                </div>
                            </section>
                        ) : (
                            <section id="admin-login" className="section-padding">
                                <div className="container">
                                    <h2>管理員登錄</h2>
                                    <input
                                        type="email"
                                        placeholder="Email"
                                        className="border p-2 mr-2 mb-2"
                                        value={email}
                                        onChange={(e) => setEmail(e.target.value)}
                                    />
                                    <input
                                        type="password"
                                        placeholder="密碼"
                                        className="border p-2 mr-2 mb-2"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                    />
                                    <button
                                        className="bg-green-500 text-white px-4 py-2 rounded"
                                        onClick={handleLogin}
                                    >
                                        登錄
                                    </button>
                                </div>
                            </section>
                        )}
                    </main>

                    <footer>
                        <div className="container">
                            <p>© 2025 承信環境科技股份有限公司. All rights reserved.</p>
                        </div>
                    </footer>
                </div>
            );
        }

        // 渲染應用
        ReactDOM.render(<App />, document.getElementById("root"));
    </script>
</body>
</html>
